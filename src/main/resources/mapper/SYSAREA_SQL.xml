<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.fscom.firsens.sys.repository.SYSAreaRepo">
    <select id="SELECT_LIST_SYS_AREA" parameterType="SYSAreaDomain" resultType="SYSAreaDomain">
        SELECT FA.AREANAME                                      AS areaName
             , FA.AREACODE                                      AS areaCode
             , FM.MEMNAME                                       AS areaManager
             , FM.MEMMOBILE                                     AS areaTel
             , FA.USEYN                                         AS useYn
             , FA.DELYN                                         AS delYn
             , DATE_FORMAT( FA.REGDATE, '%Y-%m-%d %H:%i:%s' )   AS regDate
             , IFNULL( FS.STORECNT,0 )                          AS storeCnt
             , FA.AREAORDER                                     AS areaOrder
             , FA.AREACODE                                      AS areaCodeKey
        FROM F_AREA FA
        LEFT JOIN F_MEMBER FM
        ON FM.USERID = FA.USERID
        LEFT JOIN ( SELECT AREACODE, COUNT( AREACODE ) AS STORECNT FROM F_STORE GROUP BY AREACODE ) FS
        ON FA.AREACODE = FS.AREACODE
        WHERE 1 = 1
        ORDER BY FA.AREAORDER, FA.AREACODE
        LIMIT #{ page }, #{ sizePerPage }
    </select>

    <select id="SELECT_CNT_SYS_AREA" parameterType="SYSAreaDomain" resultType="int">
        SELECT COUNT( AREACODE )
        FROM F_AREA
        WHERE 1 = 1
    </select>
</mapper>
