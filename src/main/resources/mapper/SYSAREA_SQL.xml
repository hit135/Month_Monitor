<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.fscom.firsens.sys.repository.SYSAreaRepo">
    <select id="SELECT_LIST_SYS_AREA" parameterType="SYSAreaDomain" resultType="SYSAreaDomain">
        SELECT A.AREACODE                                                  AS areaCode
             , A.AREANAME                                                  AS areaName
             , A.AREAORDER                                                 AS areaOrder
             , A.UPAREACODE                                                AS upAreaCode
             , A.AREAPOSLAT                                                AS areaPosLat
             , A.AREAPOSLON                                                AS areaPosLon
             , A.AREAMANAGER                                               AS areaManager
             , A.AREATEL                                                   AS areaTel
             , A.USEYN                                                     AS useYn
             , A.DELYN                                                     AS delYn
             , A.USERID                                                    AS userId
             , DATE_FORMAT(A.REGDATE, '%Y-%m-%d %H:%i:%s')                 AS regDate
             , A.AREALEVEL                                                 AS areaLevel
             , A.GUCODE                                                    AS guCode
             , IFNULL(FS.STORECNT, 0)                                    AS storeCnt
        FROM F_LEVEL_AREA A
                 LEFT JOIN (SELECT AREACODE, COUNT(AREACODE) AS STORECNT FROM F_STORE GROUP BY AREACODE) FS
                           ON A.AREACODE = FS.AREACODE
        WHERE 1 = 1
        ORDER BY areaLevel, areaOrder
           LIMIT #{page}, #{sizePerPage}
    </select>

    <select id="SELECT_CNT_SYS_AREA" parameterType="SYSAreaDomain" resultType="int">
        SELECT COUNT( AREACODE )
        FROM F_LEVEL_AREA
        WHERE 1 = 1
    </select>
</mapper>
