<div class="row">
  <div class="col-12">
    <p class="">
      <span class="name"></span>
      <span class="danger"><span class="badge badge-danger p-1"><i class="fal fa-siren-on text-white" style="font-size:20px;"></i></span></span>
      <span class="warn"><span class="badge badge-warning p-1"><i class="fal fa-exclamation-triangle text-white" style="font-size:20px;"></i></span></span>
    </p>
  </div>
  <div class="list-area col-12">
  </div>
  <div class="col-12">
    <div class="sensors-CHECK" style="border:1px solid #6c757d; margin:15px;">
      <h3 class="bg-secondary"><i class="fal fa-sensor-alert"></i> 점검 <span class="cnt"></span></h3>
      <div class="left-list-sensor">
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(function() {
    fn_initLeft();
  });

  function fn_initLeft() {
    $.template('left-area', '<p class="area-lv{{html LEVEL}}" data-code="{{html CODE}}"><span class="name">{{html NAME}}</span><span class="danger">{{html DANGER}}</span><span class="warn">{{html WARN}}</span></p>');
    $.template('left-check-sensor', '<p class="left-check-sensor" data-areacode="{{html AREACODE}}" data-strcode="{{html STRCODE}}" data-code="{{html SNSRID}}">{{html AREANAME}}_{{html SNSRNICK}} ({{html CNT}})</p>');
    $('.left').on('click', '.area-lv2', function() {
      $('.left .area-lv2.on').removeClass('on');
      $(this).addClass('on');
      fn_clickAreaLv2($(this).attr('data-code'));
    });
    $('.left-list-sensor').on('click','p',function(){
      fn_clickRightSensor($(this).attr('data-areacode'), $(this).attr('data-strcode'));
    });
    fn_getAreaList();
    fn_getCheckSensorList();
  }

  function fn_refreshLeft() {
    fn_getAreaList();
    fn_getCheckSensorList();
  }

  function fn_getAreaList() {
    window.left_area_lv2_on_code = $('.left .area-lv2.on').attr('data-code');
    $.post($('#contextRoot').val()+'/mng/areaListAjax',{},function(d) {
      $('.list-area').html('');
      for(var i=0; i<d.length; i++)
        if(d[i].LEVEL == 1) $('.list-area').append($.tmpl('left-area', d[i]));
        else $('.list-area p[data-code="'+d[i].UPCODE+'"]').after($.tmpl('left-area', d[i]));
    });
  }

  function fn_getCheckSensorList() {
    $.post($('#contextRoot').val()+'/mng/checkSensorListAjax',{},function(d) {
      $('.left-list-sensor').html('');
      for(var i=0; i<d.length; i++)
        $('.sensors-'+d[i].STATE+' .left-list-sensor').append($.tmpl('left-check-sensor', d[i]));
      $('.sensors-CHECK .cnt').text('('+$('.sensors-CHECK .left-list-sensor p').length+')');
    });
  }

</script>